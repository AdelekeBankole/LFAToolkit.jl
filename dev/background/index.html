<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mathematical Background · LFAToolkit.jl</title><link rel="canonical" href="https://jeremylt.github.io/LFAToolkit.jl/stable/background/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">LFAToolkit.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Mathematical Background</a><ul class="internal"><li><a class="tocitem" href="#Local-Fourier-Modes"><span>Local Fourier Modes</span></a></li><li><a class="tocitem" href="#Jacobi-Smoother"><span>Jacobi Smoother</span></a></li><li><a class="tocitem" href="#Multigrid"><span>Multigrid</span></a></li><li><a class="tocitem" href="#Custom-Smoothers"><span>Custom Smoothers</span></a></li></ul></li><li><span class="tocitem">Public API</span><ul><li><a class="tocitem" href="../public/">Overview</a></li><li><a class="tocitem" href="../public/mesh/">Rectangular Mesh</a></li><li><a class="tocitem" href="../public/basis/">Finite Element Basis</a></li><li><a class="tocitem" href="../public/evaluationmode/">Basis Evaluation Mode</a></li><li><a class="tocitem" href="../public/operatorfield/">Operator Field</a></li><li><a class="tocitem" href="../public/operator/">Finite Element Operator</a></li><li><a class="tocitem" href="../public/pc_jacobi/">Preconditioner: Jacobi</a></li></ul></li><li><span class="tocitem">Private API</span><ul><li><a class="tocitem" href="../private/">Overview</a></li><li><a class="tocitem" href="../private/mesh/">Rectangular Mesh</a></li><li><a class="tocitem" href="../private/basis/">Finite Element Basis</a></li><li><a class="tocitem" href="../private/operator/">Finite Element Operator</a></li><li><a class="tocitem" href="../private/pc_jacobi/">Preconditioner: Jacobi</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Mathematical Background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mathematical Background</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jeremylt/LFAToolkit.jl/blob/master/docs/src/background.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Mathematical-Background"><a class="docs-heading-anchor" href="#Mathematical-Background">Mathematical Background</a><a id="Mathematical-Background-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Background" title="Permalink"></a></h1><p>Local Fourier Analysis was first used by Brandt [1] to analyze the convergence of multi-level adaptive techniques for solving PDEs discretized with finite differences, but the technique has been adapted for multi-level and multi-grid techniques more broadly with finite element discretizations.</p><p>By way of example, we will explore Local Fourier Analysis for iterative solvers and mutli-grid methods for the two dimensional Poisson problem, given by the PDE</p><div>\[- \nabla^2 u = f.\]</div><h2 id="Local-Fourier-Modes"><a class="docs-heading-anchor" href="#Local-Fourier-Modes">Local Fourier Modes</a><a id="Local-Fourier-Modes-1"></a><a class="docs-heading-anchor-permalink" href="#Local-Fourier-Modes" title="Permalink"></a></h2><p>Local Fourier Analysis considers the local properties of the descretized system via its Fourier modes and the eigenvalues of the associated symbol matrix. We will describe the simple one dimensional scalar case and extend it to an arbitrary dimension, degree, and component finite element problem.</p><p>First consider a scalar Toeplitz operator <span>$L_h$</span> on a one dimensional infinite uniform grid <span>$G_h$</span>. This operator is given by</p><div>\[L_h \mathrel{\hat{=}} \left[ s_\kappa \right]_h \left( \kappa \in V \right)

L_h w_h \left( x \right) = \sum_{\kappa \in V} s_\kappa w_h \left( x + \kappa h \right)\]</div><p>where <span>$V \subset \mathcal{Z}$</span> is a finite index set, <span>$s_\kappa \in \mathcal{R}$</span> are constant coefficients, and <span>$w_h \left( x \right)$</span> is a <span>$l^2$</span> function on <span>$G_h$</span>.</p><p>As <span>$L_h$</span> is Toeplitz, it can be diagonalized by the standard Fourier modes <span>$\varphi \left( \theta, x \right) = e^{\imath \theta x / h}$</span>.</p><p>If for all grid functions <span>$\varphi \left( \theta, x \right)$</span> we have</p><div>\[S_h \varphi \left( \theta, x \right) = \tilde{L}_h \left( \theta \right) \varphi \left( \theta, x \right)\]</div><p>then <span>$\tilde{L}_h \left( \theta \right) = \sum_{\kappa \in V} s_\kappa e^{\imath \theta \kappa}$</span> is the <strong>symbol</strong> of <span>$L_h$</span>.</p><p>We can extend this to a <span>$p \times p$</span> linear system of operators representing a scalar problem on a <span>$p$</span> order finite element</p><div>\[L_h = \begin{bmatrix}
    L_h^{1, 1}  &amp;  \cdots  &amp;  L_h^{1, p}  \\
    \vdots      &amp;  \vdots  &amp;  \vdots      \\
    L_h^{p, 1}  &amp;  \cdots  &amp;  L_h^{p, p}
\end{bmatrix}\]</div><p>where <span>$L_h^{i, j}$</span> is given by a scalar Toeplitz operator describing how component <span>$j$</span> appears in the equation for component <span>$i$</span>.</p><p>...</p><p>The Poisson problem has the weak formulation</p><div>\[\int_{\Omega} \nabla u \cdot \nabla v - \int_{\partial \Omega} \nabla u v = \int_{\Omega} f v, \forall v \in V\]</div><p>for some suitable <span>$V \subseteq H_0^1 \left( \Omega \right)$</span>.</p><p>The bilinear formulation for the diffusion operator associated with this weak form is given by</p><div>\[a \left( u, v \right) = \int_{\Omega} \nabla u \cdot \nabla v.\]</div><p>Selecting a finite element basis, we can discretize the operator and produce a Toeplitz operator <span>$A$</span> . Assuming a H1 Lagrange basis of polynomial order <span>$p$</span>, the assembled element matrix is of the form</p><div>\[A_e = [a_{i, j}]\]</div><p>where <span>$i, j \in \lbrace 0, 1, 2, \dots, p \rbrace$</span>. This operator can be diagonalized by the Fourier functions <span>$\varphi \left(\mathbf{\theta}, \mathbf{x} \right) = e^{\imath \mathbf{\theta} \cdot \mathbf{x} / h}$</span>.</p><p>Thus, we have the symbol matrix</p><div>\[\tilde{A} \left( \mathbf{\theta} \right) = \]</div><p>The Fourier modes can thus be represented as</p><div>\[S \left( \mathbf{\theta}, \mathbf{x} ) = [a_{i, j} e^{\imath \mathbf{\theta} \cdot \mathbf{x} / h}].\]</div><p>However, notice that <span>$a_{i, j} e^{\imath \mathbf{\theta} \cdot \mathbf{x} / h}$</span> and <span>$a_{k, l} e^{\imath \mathbf{\theta} \cdot \mathbf{x} / h}$</span> are equivalent when <span>$i = k \left( mod p \right)$</span> and <span>$j = l \left( mod p \right)$</span>.</p><p>Do I want to include an explanation as to why this is the Fourier basis? I will need to put that somewhere eventually.</p><p>Really this sentence is a note to users. I&#39;m not sure where to put it, but it should be included. Perhaps in a yet to be formed code example section?</p><p>This Local Fourier Analysis toolkit uses the algebraic representation of PDE operators discussed in [2].</p><h2 id="Jacobi-Smoother"><a class="docs-heading-anchor" href="#Jacobi-Smoother">Jacobi Smoother</a><a id="Jacobi-Smoother-1"></a><a class="docs-heading-anchor-permalink" href="#Jacobi-Smoother" title="Permalink"></a></h2><p>M is not based on theta here, but S = I - M^-1 A is</p><h2 id="Multigrid"><a class="docs-heading-anchor" href="#Multigrid">Multigrid</a><a id="Multigrid-1"></a><a class="docs-heading-anchor-permalink" href="#Multigrid" title="Permalink"></a></h2><p>Here, P and R are based on theta as well. Will want to describe with any smoother dropped into the multigrid (as in the code).</p><h2 id="Custom-Smoothers"><a class="docs-heading-anchor" href="#Custom-Smoothers">Custom Smoothers</a><a id="Custom-Smoothers-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Smoothers" title="Permalink"></a></h2><p>Example of user defined smoother. User provides element matrix and code maps to symbols.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../public/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 8 October 2020 00:01">Thursday 8 October 2020</span>. Using Julia version 1.5.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
